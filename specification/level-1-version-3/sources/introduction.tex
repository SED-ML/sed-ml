% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%% INTRODUCTION
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\chapter{Introduction}
The Simulation Experiment Description Markup Language (SED-ML) is an XML-based format for the description of simulation experiments.

The number of computational models of biological systems is growing at an ever increasing pace. 
At the same time, their size and complexity are also increasing. It is now generally accepted that one must be able to exchange the mathematical structure of such models, for instance to build on existing studies by reusing models or for the reproduction of model results. The efforts to standardise the representation of computational models in various areas of biology, such as the Systems Biology Markup Language (SBML) \citep{Hucka:2003}, CellML \citep{cuellar:2003} or NeuroML \citep{Goddard:2001}, resulted in an increase of the exchange and re-use of models. 

However, the description of the structure of models is not sufficient for the reproduction of simulation results. One also needs to describe the procedures the models are subjected to, i.e. the minimal set of information that should be provided to allow the reproduction of simulation experiments among users and software tools as described by the Minimum Information About a Simulation Experiment (MIASE \citep{Waltemath:2011}). The increasing use of computational simulation experiments to inform modern biological research creates new challenges to reproduce, annotate, archive, and share such experiments. 

SED-ML describes in a computer-readable exchange format the information to enable the reproduction of simulation experiments. SED-ML is a software-independent format encoded in the Extensible Markup Language (XML) \citep{Bray:2006} not specific to particular simulation tools and independent of the underlying model implementation.

SED-ML is developed as a community project and defined via a detailed technical specification and a corresponding XML Schema. 

This document describes \currentLV of SED-ML which is the successor of \previousLV and \LoneVone (described in \citep{WAB+11}).

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%% OVERVIEW
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\section{SED-ML overview}
A SED-ML document specifies for a given simulation experiment

\begin{itemize}
\item what datasets to use
\item which models to use in an simulation experiment
\item which modifications to apply to models before simulation
\item which simulation procedures to run on each model
\item what analysis results to plot or report
\item and how these results should be presented
\end{itemize}

SED-ML containts the following main objects to describe this information: \code{DataDescription} (\ref{class:dataDescription}), \code{Model} (\ref{class:model}), \code{Simulation} (\ref{class:simulation}), \code{Task} (\ref{class:task}), \code{DataGenerator} (\ref{class:dataGenerator}), and \code{Output} (\ref{class:output}).

\paragraph*{\hyperref[class:dataDescription]{DataDescription}}
The \code{DataDescription} (\ref{class:dataDescription}) allows to specify data sets used in a simulation experiment. Such data can be used for instance for parametrization of model simulations or to plot data with simulation results.

\paragraph*{\hyperref[class:model]{Model}}
The \code{Model} (\ref{class:model}) is used to reference the models used in the simulation experiment. SED-ML itself is independent of the model encoding underlying the models. The only requirement is that the model is referenced by an unambiguous identifier, for example using a MIRIAM URI. To specify the language in which the model is encoded, a set of predefined language URNs is provided.

The SED-ML \code{Change} (\ref{class:change}) allows the application of changes to the referenced models, including changes on the XML attributes, e.g. changing the value of an observable, computing the change of a value using mathematics, or general changes on any XML element of the model representation that is addressable by XPath expressions, e.g. substituting a piece of XML by an updated one.

\paragraph*{\hyperref[class:simulation]{Simulation}}
The \code{Simulation} (\ref{class:simulation}) defines the simulation settings and the steps taken during simulation. These include the particular type of simulation and the algorithm used for the execution of the simulation.

\paragraph*{\hyperref[class:task]{Task}}
SED-ML makes uses the \code{Task} (\ref{class:task}) to combine a defined model (from \code{Model}) and a defined simulation setting (from \code{Simulation}).

\paragraph*{\hyperref[class:dataGenerator]{DataGenerator}}
The \code{DataGenerator} class (\ref{class:dataGenerator}) allows to encode post-processing of simulation results before output, e.g. one might want to normalise a plot before output, or apply post-processing like mean-value calculation. In the definition of a \code{DataGenerator}, any addressable variable or parameter of any defined model may be referenced, and new entities might be specified using MathML.

\paragraph*{\hyperref[class:output]{Output}}
The \code{Output} (\ref{class:output}) defines the output of the simulation, which can be either a two dimensional plot \code{Plot2D} (\ref{class:plot2D}), a three dimensional plot \code{Plot3D} (\ref{class:plot3D}), or data table \code{Report} (\ref{class:report}). The \code{Output} is based on the \code{DataGenerator}s.

This section provided a high level overview over the content of a SED-ML file. For the detailed technical specification see Chapter~\ref{chp:specification}. 

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%% EXAMPLE SIMULATION
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\section{A simulation experiment}
\label{motivation:example}
In this section an introductory example is given how simulation experiments can be described with SED-ML. The example experiment uses the \emph{repressilator} \citep{Elowitz:2000} a famous model capable of displaying rich and variable behaviors.

The \emph{repressilator} is a synthetic oscillating network of transcription regulators in Escherichia coli. The network is composed of the three repressor genes Lactose Operon Repressor (lacI), Tetracycline Repressor (tetR) and Repressor CI (cI), which code for proteins binding to the promoter of the other, blocking their transcription. The three inhibitions together in tandem, form a cyclic negative-feedback loop. To describe the interactions of the molecular species involved in the network, the authors built a simple mathematical model of coupled first-order differential equations. All six molecular species included in the network (three mRNAs, three repressor proteins) participated in creation (transcription/translation) and degradation processes. The model was used to determine the influence of the various parameters on the dynamic behavior of the system. In particular, parameter values were sought which induce stable oscillations in the concentrations of the system components. Oscillations in the levels of the three repressor proteins can be obtained by numerical integration. 

\hl{TODO MK: add sample experiment to examples in appendix}
\hl{TODO MK: create simulation results with tellurium and SED-ML webtools to show reproducibility}

%% ~~ TIMECOURSE ~~
\subsection{A time-course simulation}
\label{sec:timecourse}
The first simulation experiment we run with the model reproduces the oscillation behavior of the model shown in Figure~1c of the reference publication \citep{Elowitz:2000}. This simulation experiment can be described as:

\begin{enumerate}
 	\item{Import the model identified by the Unified Resource Identifier (URI) \citep{Berners-Lee:2005}\\ 	\url{urn:miriam:biomodels.db:BIOMD0000000012}.}
 	\item {Select a deterministic simulation method.}
 	\item{Run a uniform time course simulation for 1000~min with an output interval of 1~min.}
 	\item{Plot the amount of \code{lacI}, \code{tetR} and \code{cI} against time in a 2D Plot.}
 \end{enumerate}

Following those steps and performing the simulation in the simulation tools supporting SED-ML results in the output depicted in \fig{rep_tc}. \hl{TODO: legend and xaxis label missing, rerun with tellurium and SED-ML webtools.}

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.6\textwidth]{examples/rep_tc.png}
	\caption{Time-course simulation of the repressilator model, imported from BioModels Database and simulated in COPASI. The number of repressor proteins lacI, tetR and cI is depicted.}
	\label{fig:rep_tc}
\end{figure}


%% ~~ PRE-PROCESSING ~~
\subsection{Applying pre-processing}
\label{sec:preprocessing}
Before simulation model parameters can be adjusted. When changing the parameter values \emph{protein copies per promoter} \code{tps$\_$repr} and \emph{leakiness in protein copies per promoter} \code{tps$\_$active} like depicted below, the system's behavior switches from sustained oscillations to damped oscillations towards an asymptotic steady-state. The model changes leading to that behavior are described as: 

\begin{enumerate}
	\item{Import the model as above.}
	\item{Change the value of the parameter \code{tps$\_$repr} from “0.0005” to “1.3e-05”.}
	\item{Change the value of the parameter \code{tps$\_$active} from “0.5 “ to “0.013“.}
	\item{Select a deterministic method.}
	\item{Run a uniform time course for the duration of 1000~min with an output interval of 1~min.}
	\item Plot the amount of lacI, tetR and cI against time in a 2D Plot.
\end{enumerate}

\fig{rep_pre} shows the result of the simulation.

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.7\textwidth]{examples/rep_pre.png}
	\caption{Time-course simulation of the repressilator model, imported from BioModels Database and simulated after modification of the initial parameter values of the \emph{protein copies per promoter} and the \emph{leakiness in protein copies per promoter}. The number of repressor proteins lacI, tetR and cI are depicted.}
	\label{fig:rep_pre}
\end{figure}

%% ~~ POST-PROCESSING ~~
\subsection{Applying post-processing}
\label{sec:postprocessing}
The raw numerical output of the simulation steps may be subjected to data post-processing before plotting or reporting. In order to describe the production of a normalized plot of the time-course in the first example (section \ref{sec:timecourse}), depicting the influence of one variable on another (in phase-planes), one performes the additional steps:

(Please note that the description steps 1 - 4 remain as given in section \ref{sec:timecourse} above.)
\begin{enumerate}
	\item[5.]{Collect lacI(t) , tetR(t) and cI(t).}
	\item[6.]{Compute the highest value for each of the repressor proteins, max(lacI(t)), max(tetR(t)), max(cI(t)).}
	\item[7.]{Normalize the data for each of the repressor proteins by dividing each time point by the maximum value, i.\,e.\ lacI(t)/max(lacI(t) ), tetR(t)/max(tetR(t)) , and cI(t)/max(cI(t)).}
	\item[8.]{Plot the normalized \code{lacI} protein as a function of the normalized \code{cI}, the normalized \code{cI}  as a function of the normalized \code{tetR} protein, and the normalized \code{tetR} protein against the normalized \code{lacI} protein in a 2D plot.}
\end{enumerate}

\fig{rep_post} illustrates the result of the simulation after post-processing of the output data. 
	\begin{figure}[ht]
	\centering
	\includegraphics[width=0.7\textwidth]{examples/rep_post.png}
	\caption{Time-course simulation of the repressilator model imported from BioModels Database and simulated with COPASI. Depicted is the normalized temporal evolution of lacI, tetR and cI in phase-plane.}
	\label{fig:rep_post}
\end{figure}
