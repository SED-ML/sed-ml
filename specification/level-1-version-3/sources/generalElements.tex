\section{General attributes and classes}
In this section we introduce attributes and concepts used repeatedly throughout the SED-ML specification. 


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% ID
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{\element{id}}
\label{sec:id}

Most objects in SED-ML carry an \concept{id} attribute. The \hyperref[sec:id]{id} attribute, if it exists for an object, is always required and identifies SED-ML constituents unambiguously. The data type for \code{id} is \code{SId} which is a datatype derived from the basic XML type \code{string}, but with restrictions about the characters permitted and the sequences in which those characters may appear. The definition is shown in Figure~\vref{fig:sid}.

\begin{figure}[hbt]
  \ttfamily
  \small
  \centering
  \begin{tabular}{lll}
    letter & ::= & 'a'..'z','A'..'Z'\\
    digit  & ::= & '0'..'9'\\
    idChar & ::= & letter | digit | '\_'\\
    SId    & ::= & ( letter | '\_' ) idChar*\\
  \end{tabular}
  \vspace*{-1ex}
  \caption{The definition of the type \code{SId}}
  \label{fig:sid}
\end{figure}

For a detailed description see also the SBML specification on the ``Type SId'' \citep[p. 11]{HBH+10}.

All \code{id}s have a global scope, i.\,e.\ the \code{id} must be unambiguous throughout a whole SED-ML document. As such it identifies the constituent it is related to.

An example for a defined \concept{id} is given in Listing~\ref{lst:id}.

\begin{myXmlLst}{SED-ML identifier definition, e.\,g.\ for a model}{lst:id}
<model id="m00001" language="urn:sedml:language:sbml" source="urn:miriam:biomodels.db:BIOMD0000000012">
 [MODEL DEFINITION]
</model>
\end{myXmlLst}

The defined model carries the  \code{id} \code{m00001}. If the model is referenced elsewhere in the SED-ML document, it is referred to by that \code{id}.


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% NAME
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{\element{name}}
\label{sec:name}

Besides an \hyperref[sec:id]{id}, a SED-ML constituent may carry an optional \concept{name}. However, names do not have identifying character;  several SED-ML constituents may carry the same name. The purpose of the \code{name} attribute is to keep a human-readable name of the constituent, e.\,g.\ for display to the user. In the XML Schema representation, names are of the data type \code{String}.

Listing \ref{lst:name} extends the model definition in \lst{id} by a model name.

\begin{myXmlLst}{SED-ML name definition, e.\,g.\ for a model}{lst:name}
<model id="m00001" name="Circadian oscillator" language="urn:sedml:language:sbml" source="urn:miriam:biomodels.db:BIOMD0000000012">
 [MODEL DEFINITION]
</model>
\end{myXmlLst}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% SEDBASE
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{\element{SEDBase}}
\label{class:sedBase}

\concept{SEDBase} is the base class  of SED-ML \currentLV. All other classes are derived from it. As such it provides means to attach additional information on all other classes  (\fig{sedBase}). That information can be specified by human readable \hyperref[class:notes]{Notes} or custom \hyperref[class:annotation]{Annotations}. 

\sedfig[width=0.9\textwidth]{pdf/sedBaseClass}{The SEDBase class}{fig:sedBase}

\tabtext{sedbase}{SEDBase}

\begin{table}[ht]
\center
\begin{tabular}{|l|l|}
\hline
\textbf{\attribute} & \textbf{\desc}\\
\hline
metaid$^{o}$ & \refpage{sec:metaID} \\
\hline
\hline
\textbf{\subelements} & \textbf{\desc}\\
\hline
notes$^{o}$ & \refpage{class:notes}\\
annotation$^{o}$ & \refpage{class:annotation}\\
\hline
\end{tabular}
\caption{\tabcap{SEDBase}}
\label{tab:sedbase}
\end{table}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% META ID
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsubsection{\element{metaid}}
\label{sec:metaID}

The main purpose of the \element{metaid} attribute is to attach semantic annotations in form of the \hyperref[class:annotation]{Annotation} class to SED-ML elements. The type of \code{metaid} is XML ID and as such the \code{metaid} attribute is globally unique throughout the whole SED-ML document. 

An example showing how to link a semantic annotation to a SED-ML object via the \element{metaid} is given in the \hyperref[class:annotation]{Annotation} class description.

All \code{metaid}s have a global scope, i.\,e.\ the \code{metaid} must be unambiguous throughout a whole SED-ML document. As such it identifies the constituent it is related to.

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% NOTES
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsubsection{\element{Notes}}
\label{class:notes}

A \concept{note} is considered a  human-readable description of the element it is assigned to. It serves to display information to the user. Instances of the \concept{Notes} class may contain any valid XHTML \citep{P+02}, ranging from short comments to whole HTML pages for display in a Web browser. The namespace URL for \code{XHTML} content inside the \hyperref[class:notes]{Notes} class is \url{http://www.w3.org/1999/xhtml}. It may either be declared in the \hyperref[class:sed-ml]{\code{sedML} XML element}, or directly used in top level XHTML elements contained within the  \code{notes} element. For further options of how to set the namespace and detailed examples, please refer to \citep[p. 14]{HBH+10}.

\tabtext{notes}{Notes}

\begin{table}[ht]
\center
\begin{tabular}{|l|l|}
\hline
\textbf{\attribute} & \textbf{\desc}\\
\hline
xmlns:string & \refpage{sec:xmlns} \\
 {``http://www.w3.org/1999/xhtml" } & \\
\hline
\hline
\textbf{\subelements} & \textbf{ }\\
\hline
\emph{well-formed content permitted in XHTML} & \\
\hline
\end{tabular}
\caption{\tabcap{Notes}}
\label{tab:notes}
\end{table}

\code{Notes} does not have any further sub-elements defined in SED-ML, nor attributes associated with it.

\lsttext{notes}{notes}

\begin{myXmlLst}{The \element{notes} element}{lst:notes}
<sedML [..]>
 <notes >
  <p xmlns="http://www.w3.org/1999/xhtml">The enclosed simulation description shows the oscillating behaviour of 
     the Repressilator model using deterministic and stochastic simulators.</p>
 </notes>
</sedML>
\end{myXmlLst}

In this example, the namespace declaration is inside the \element{notes} element and the note is related to the \element{sedML} root element of the SED-ML file. A note may, however, occur inside \emph{any} SED-ML XML element, except \code{note} itself and \hyperref[class:annotation]{\code{annotation}}.


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% ANNOTATION
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsubsection{\element{Annotation}}
\label{class:annotation}

An \concept{annotation} is considered a computer-processible piece of information. Annotations may contain any valid XML content. For further guidelines on how to use annotations, we would like to encourage the reading of the corresponding section in the SBML specification \citep[pp. 14-16]{HBH+10}. The style of annotations in SED-ML is briefly described in Section~\ref{sec:annotations} on page \pageref{sec:annotations}.

\tabtext{annotation}{Annotation}

\begin{table}[ht]
\center
\begin{tabular}{|l|l|}
\hline
\textbf{\attribute} & \textbf{\desc}\\
\hline
\emph{none} & \\
\hline
\hline
\textbf{\subelements} & \textbf{\desc}\\
\hline
\emph{none in the SED-ML namespace} & \\
\hline
\end{tabular}
\caption{\tabcap{Annotation}}
\label{tab:annotation}
\end{table}

\lsttext{annotation}{annotation}

\begin{myXmlLst}{The annotation element}{lst:annotation}
<sedML>
  [..]
  <model id="model1" metaid="_001" language="urn:sedml:language:cellml" 
   source="http://models.cellml.org/workspace/leloup_gonze_goldbeter_1999/@@rawfile/d6613d7e1051b3eff2bb1d3d419a445bb8c754ad/leloup_gonze_goldbeter_1999_a.cellml" >
   <annotation>
    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
             xmlns:bqmodel="http://biomodels.net/model-qualifiers/">
     <rdf:Description rdf:about="#_001">
      <bqmodel:isDescribedBy>
       <rdf:Bag>
        <rdf:li rdf:resource="urn:miriam:pubmed:10415827"/>
       </rdf:Bag>
      </bqmodel:isDescribedBy>
     </rdf:Description>
    </rdf:RDF>
   </annotation>
  </model>
  [..]
</sedML>
\end{myXmlLst}

In that example, a SED-ML \hyperref[class:model]{model} element is annotated with a reference to the original publication. The \element{model} contains an \element{annotation} that uses the \concept{biomodels.net model-qualifier} \element{isDescribedBy} to link to the external resource \element{urn:miriam:pubmed:10415827}. In natural language the annotation content could be interpreted as ``The model \emph{is described by} the published article available from \emph{pubmed} under ID \emph{10643740}''. The example annotation follows the proposed \hyperref[sec:uriScheme]{URI Scheme} suggested by the MIRIAM reference standard. The MIRIAM URN can be resolved to the PubMED (\url{http://pubmed.gov}) publication with ID 10415827, namely the article ``Alternating oscillations and chaos in a model of two coupled biochemical oscillators driving successive phases of the cell cycle.'' published by Romond et al. in  1999.


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% SED-ML
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{\element{SED-ML} top level element}
\label{class:sed-ml}
Each SED-ML \currentLV document has a main class called SED-ML which defines the document's structure and content (\fig{sed-mlMain}).
%
%\sedfig[width=0.35\textwidth]{pdf/sed-mlClass}{The SED-ML class}{fig:sed-ml}
%
It consists of several parts; the parts are all connected to the SED-ML class through aggregation: 
the \hyperref[class:dataDescription]{DataDescription} class (for resolving external data, see Section~\ref{class:dataDescription}),
the \hyperref[class:model]{Model} class (for model specification, see Section~\ref{class:model}),
the \hyperref[class:simulation]{Simulation} class (for simulation setup specification, see Section~\ref{class:simulation}),
the \hyperref[class:abstractTask]{AbstractTask} class (for the linkage of models and simulation setups, see Section~\ref{class:abstractTask}),
the \hyperref[class:dataGenerator]{DataGenerator} class (for the definition of post-processing, see Section~\ref{class:dataGenerator}),
and the \hyperref[class:output]{Output} class (for the output specification, see Section~\ref{class:output}).
All of them are shown in \fig{sed-mlMain} and will be explained in more detail in the relevant sections of this document.

\sedfig[width=0.8\textwidth]{pdf/sed-mlMain}{The sub-classes of SED-ML}{fig:sed-mlMain}

\tabtext{sed-ml}{SED-ML}

\begin{table}[ht]
\center
\begin{tabular}{|l|l|}
\hline
\textbf{\attribute} & \textbf{\desc}\\
\hline
metaid$^{o}$ & \refpage{sec:metaID}\\
xmlns & \refpage{sec:xmlns}\\
level & \refpage{sec:level}\\
version & \refpage{sec:version}\\
\hline
\hline
\textbf{\subelements} & \textbf{\desc}\\
\hline
notes$^{o}$ & \refpage{class:notes}\\
annotation$^{o}$ & \refpage{class:annotation}\\
listOfDataDescriptions$^{o}$ & \refpage{sec:listOfDataDescriptions}\\
listOfModels$^{o}$ & \refpage{sec:listOfModels}\\
listOfSimulations$^{o}$ & \refpage{sec:listOfSimulations} \\
listOfTasks$^{o}$ & \refpage{sec:listOfTasks} \\
listOfDataGenerators$^{o}$ & \refpage{sec:listOfDataGenerators} \\
listOfOutputs$^{o}$ & \refpage{sec:listOfOutputs} \\
\hline
\end{tabular}
\caption{\tabcap{SED-ML}}
\label{tab:sed-ml}
\end{table}

A SED-ML document needs to have the SED-ML namespace defined through the mandatory \hyperref[sec:xmlns]{xmlns} attribute. In addition, the SED-ML \hyperref[sec:level]{level} and \hyperref[sec:version]{version} attributes are mandatory.

The basic XML structure of a SED-ML file is shown in listing  \vref{lst:sedmlRoot}.

\begin{myXmlLst}{The SED-ML root element}{lst:sedmlRoot}
<?xml version="1.0" encoding="utf-8"?>
<sedML xmlns:math="http://www.w3.org/1998/Math/MathML" 
       xmlns="http://sed-ml.org/sed-ml/level1/version3" level="1" version="3">
 <listOfDataDescriptions />
  [DATA REFERENCES AND TRANSFORMATIONS]
 <listOfModels />
  [MODEL REFERENCES AND APPLIED CHANGES]
 <listOfSimulations />
  [SIMULATION SETUPS]
 <listOfTasks />
  [MODELS LINKED TO SIMULATIONS]
 <listOfDataGenerators />
  [DEFINITION OF POST-PROCESSING]
 <listOfOutputs />
  [DEFINITION OF OUTPUT]
</sedML>
\end{myXmlLst}

The root element of each SED-ML XML file is the \code{sedML} element, encoding \hyperref[sec:version]{version} and \hyperref[sec:level]{level} of the file, and setting the necessary namespaces. Nested inside the \code{sedML} element are the six lists serving as containers for the encoded data (\concept{listOfDataDescriptions} for all external data sources, \concept{listOfModels} for all models, \concept{listOfSimulations} for all simulations, \concept{listOfTasks} for all tasks, \concept{listOfDataGenerators} for all post-processing definitions, and \concept{listOfOutputs} for all output definitions).

%% ~~~ XMLNS ~~~
\subsubsection{\element{xmlns}}
\label{sec:xmlns}
The \concept{xmlns} attribute declares the namespace for the SED-ML document. The pre-defined namespace for SED-ML documents is \url{http://sed-ml.org/sed-ml/level1/version3}. 

In addition, SED-ML makes use of the \concept{MathML} namespace \url{http://www.w3.org/1998/Math/MathML} to enable the encoding of mathematical expressions in MathML 2.0. SED-ML uses a subset of MathML as described in Section~\ref{sec:mathML} on page \pageref{sec:mathML}.

SED-ML \concept{notes} use the XHTML namespace \url{http://www.w3.org/1999/xhtml}.  The \hyperref[class:notes]{Notes} class is described in Section~\ref{class:notes} on page \pageref{class:notes}.

Additional external namespaces might be used in \hyperref[class:annotation]{annotations}. 

%% ~~~ LEVEL ~~~
\subsubsection{\element{level}}
\label{sec:level}
The current SED-ML \concept{level} is ``level \level''. Major revisions containing substantial changes will lead to the definition of forthcoming levels.

The level attribute is \code{required} and its value is a \code{fixed} decimal. For SED-ML \currentLV the value is set to \code{1}, as shown in the example in Listing~\ref{lst:sedmlRoot}.

%% ~~~ VERSION ~~~
\subsubsection{\element{version}}
\label{sec:version}
The current SED-ML \concept{version} is ``version \version''. Minor revisions containing corrections and refinements of SED-ML elements, or new constructs which do not affect backwards compatibility, will lead to the definition of forthcoming versions.

The version attribute is \code{required} and its value is a \code{fixed} decimal. For SED-ML \currentLV the value is set to \code{2}, as shown in the example in Listing~\ref{lst:sedmlRoot}.


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% REFERENCE RELATION
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Reference relations}
\label{sec:reference}

The \concept{reference} concept is used to refer to a particular element inside the SED-ML document. It may occur in six different ways in the SED-ML document:

\begin{enumerate}
\item{as an association between two \hyperref[class:model]{Model}s (\hyperref[sec:modelReference]{modelReference}),}
\item{as an association between a \hyperref[class:variable]{Variable} and a \hyperref[class:model]{Model} (\hyperref[sec:modelReference]{modelReference}),}
\item{as an association between a \hyperref[class:variable]{Variable} and an \hyperref[class:abstractTask]{AbstractTask} (\hyperref[sec:taskReference]{taskReference}),}
\item{as an association between a \hyperref[class:task]{Task} and the simulated \hyperref[class:model]{Model} (\hyperref[sec:modelReference]{modelReference}),}
\item{as an association between a \hyperref[class:task]{Task} and the \hyperref[class:simulation]{Simulation} run (\hyperref[sec:simulationReference]{simulationReference}), or}
\item{as an association between an \hyperref[class:output]{Output} and a \hyperref[class:dataGenerator]{DataGenerator} (\hyperref[sec:dataReference]{dataReference}).}
\end{enumerate}

The definition of a \hyperref[class:task]{Task} object requires a reference to a particular Model object (\hyperref[sec:modelReference]{modelReference}, see Section~\ref{sec:modelReference} on page \pageref{sec:modelReference}); furthermore, the Task object must be associated with a particular Simulation object (\hyperref[sec:simulationReference]{simulationReference}, see Section~\ref{sec:simulationReference} on page \pageref{sec:simulationReference}).

Depending on the use of the \concept{reference} relation in connection with a \hyperref[class:variable]{Variable} object, it may take different roles: 

\begin{enumerate}
\item[a.]{The \concept{reference} association might occur between a Variable object and a Model object, e.g.\ if the variable is to define a \hyperref[class:change]{Change}. 
In that case the \code{variable} element contains a \hyperref[sec:modelReference]{modelReference} to refer to the particular model that contains the variable used to define the change (see Section~\ref{sec:modelReference} on page \pageref{sec:modelReference}). }
\item[b.]{If the \concept{reference} is used as an association between a Variable object and an AbstractTask object inside the \hyperref[class:dataGenerator]{dataGenerator} class, then the \code{variable} element contains a \hyperref[sec:taskReference]{taskReference} to unambiguously refer to an observable in a given task (see Section~\ref{sec:taskReference} on page \pageref{sec:taskReference}).}
\end{enumerate}

Four different types of \concept{data references} exist in SED-ML \currentLV. They are used depending on the \emph{type} of output for the simulation. A 2d plot has an \hyperref[sec:xDataReference]{xDataReference} and a \hyperref[sec:yDataReference]{yDataReference} assigned. A 3D plot has in addition a \hyperref[sec:zDataReference]{zDataReference} assigned. To define a report, each data column has a \hyperref[sec:dataReference1]{dataReference} assigned.


%% ~~ MODEL REFERENCE ~~
\subsubsection{modelReference}
\label{sec:modelReference}
%
The \concept{modelReference} either represents a relation between two \hyperref[class:model]{Model} objects, a \hyperref[class:variable]{Variable} object and a \hyperref[class:model]{Model} object, or  a relation between a \hyperref[class:task]{Task} object and a \hyperref[class:model]{Model} object.

The \code{source} attribute of a \hyperref[class:model]{Model} is allowed to reference either a URI or an \code{SId} to a second
\hyperref[class:model]{Model}. Constructs where a model \code{A} refers to a model \code{B} and \code{B} to \code{A} (directly or indirectly) are invalid.

If pre-processing needs to be applied to a model before simulation, then the model update can be specified by creating a \hyperref[class:change]{Change} object. In the particular case that a change must be calculated with a mathematical function, variables need to be defined. To refer to an existing entity in a defined \hyperref[class:model]{Model}, the \concept{modelReference} is used. 

The \code{modelReference} attribute of the \code{variable} element contains the \concept{id} of a model that is defined in the document. 
\lsttext{modelReference1}{modelReference} 

\begin{myXmlLst}{SED-ML \code{modelReference} attribute inside a variable definition of a  \code{computeChange} element}{lst:modelReference1}
<model id="m0001" [..]>
 <listOfChanges>
   <computeChange>
    <listOfVariables>
     <variable id="v1" modelReference="cellML" target="/cellml:model/cellml:component[@cmeta:id='MP']/cellml:variable[@name='vsP']/@initial_value" />
     [..]
    </listOfVariables>
    <listOfParameters [..] />
    <math>
     [CALCULATION OF CHANGE]
    </math>
   </computeChange>
 </listOfChanges>
 [..]
</model>
\end{myXmlLst}

In the example, a change is  applied on model \code{m0001}. In the \code{computeChange} element a list of variables is defined. One of those variable is \code{v1} which is defined in another model (\code{cellML}). The XPath expression given in the \hyperref[sec:target]{target} attribute identifies the variable in the model which carries the ID \code{cellML}.

The \concept{modelReference} is also used to indicate that a \hyperref[class:model]{Model} object is used in a particular  \hyperref[class:task]{Task}. Listing \ref{lst:modelReference2} shows how this can be done for a sample SED-ML document.

\begin{myXmlLst}{SED-ML \code{modelReference} definition inside a \element{task} element}{lst:modelReference2}
<listOfTasks>
 <task id="t1" name="Baseline" modelReference="model1" simulationReference="simulation1" />
 <task id="t2" name="Modified" modelReference="model2" simulationReference="simulation1" />
</listOfTasks>
\end{myXmlLst}

The example defines two different tasks; the first one applies the simulation settings of \code{simulation1} on \code{model1}, the second one applies the same simulation settings on \code{model2}.


%% ~~ TASK REFERENCE ~~
\subsubsection{taskReference}
\label{sec:taskReference}
\hyperref[class:dataGenerator]{DataGenerator} objects are created to apply post-processing to the simulation results before final output. 

For certain types of post-processing \hyperref[class:variable]{Variable} objects need to be created.
These link to a \hyperref[class:abstractTask]{task} defined within the \hyperref[sec:listOfTasks]{listOfTasks} from which the model that contains the variable of interest can be inferred. 
A \concept{taskReference} association is used to realise that link from a \hyperref[class:variable]{Variable} object inside a \hyperref[class:dataGenerator]{DataGenerator} to an \hyperref[class:abstractTask]{AbstractTask} object. 
Listing \ref{lst:reference3} gives an example.

\begin{myXmlLst}{SED-ML \code{taskReference} definition inside a \element{dataGenerator} element}{lst:reference3}
<listOfDataGenerators>
 <dataGenerator id="tim3" name="tim mRNA (difference v1-v2+20)">
  <listOfVariables>
   <variable id="v1" taskReference="t1" [..] />
  </listOfVariables>
  <math [..]/>
 </dataGenerator>
</listOfDataGenerators>
\end{myXmlLst}

The example shows the definition of a variable \code{v1} in a \code{dataGenerator} element. The variable appears in the model that is used in task \code{t1}. The task definition of \code{t1} might look as shown in Listing~\ref{lst:taskReferences}.
\begin{myXmlLst}{Use of the reference relations in a task definition}{lst:taskReferences}
<listOfTasks>
  <task id="t1" name="task definition" modelReference="model1" simulationReference="simulation1" />
</listOfTasks>
\end{myXmlLst}
Task \code{t1} references the model \code{model1}. Therefore we can conclude that the variable \code{v1} defined in \lst{reference3} targets an element of the model with ID \code{model1}. The targeting process itself will be explained in section \ref{sec:target} on \refpage{sec:target}.


%% ~~ SIMULATION REFERENCE ~~
\subsubsection{simulationReference}
\label{sec:simulationReference}
The \concept{simulationReference} is used to refer to a particular \hyperref[class:simulation]{Simulation} in a \hyperref[class:task]{Task}. Listing \ref{lst:modelReference2} shows the reference to a defined simulation for a sample SED-ML document. In the example, both tasks \code{t1} and \code{t2} use the simulation settings defined in \code{simulation1} to run the experiment.


%% ~~ DATA REFERENCE ~~
\subsubsection{dataReference}
\label{sec:dataReference}
The \concept{dataReference} is used to refer to a particular \hyperref[class:dataGenerator]{DataGenerator} instance from an \hyperref[class:output]{Output} instance. Listing \ref{lst:dataReference} shows the reference to a defined data set for a sample SED-ML document. 

\begin{myXmlLst}{Example for the use of data references in a curve definition}{lst:dataReference}
<listOfOutputs>
  <plot2D id="p1" [..] >
    <curve id="c1" xDataReference="dg1" yDataReference="dg2" />
    [..]
  </plot>
</listOfOutputs>
\end{myXmlLst}

In the example, the output type is a 2D plot, which defines one curve with id \code{c1}. A curve must refer to two different data generators which describe how to procure the data that is to be plotted on the x-axis and y-axis respectively. 


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% VARIABLE
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{\element{Variable}}
\label{class:variable}
\concept{Variables} are references to already existing entities, either existing in one of the defined \hyperref[class:model]{models} or implicitly defined \hyperref[sec:symbol]{symbols} (\fig{variable}). 
%
\sedfig[width=0.35\textwidth]{pdf/variable}{The Variable class}{fig:variable}
%
If the variable is defined through a reference to a model constituent, such as an SBML species, or to an entity within the SED-ML file itself, then the reference is specified using the \hyperref[sec:target]{target} attribute.
If the variable is defined through a reference to an \hyperref[sec:implicitVariable]{implicit variable}, rather than one explicitly appearing in the model, then the \hyperref[sec:symbol]{symbol} attribute is used, which holds a SED-ML \hyperref[sec:uriScheme]{URI}.
A \code{variable} is always placed inside a \hyperref[sec:listOfVariables]{listOfVariables}.
The \code{symbol} and \code{target} attributes must not be used together in a single instance of Variable, although at least one must be present.

\tabtext{variable}{Variable}
%
\begin{table}[ht]
\center
\begin{tabular}{|l|l|}
\hline
\textbf{\attribute} & \textbf{\desc}\\
\hline
metaid$^{o}$ & \refpage{sec:metaID}\\
id & \refpage{sec:id} \\
name$^{o}$ & \refpage{sec:name}\\
\hline
target & \refpage{sec:target}\\
symbol & \refpage{sec:symbol}\\
\hline
taskReference & \refpage{sec:taskReference}\\
modelReference & \refpage{sec:modelReference}\\
\hline
\hline
\textbf{\subelements} & \textbf{\desc}\\
\hline
notes$^{o}$ & \refpage{class:notes}\\
annotation$^{o}$ & \refpage{class:annotation}\\
\hline
\end{tabular}
\caption{\tabcap{Variable}}
\label{tab:variable}
\end{table}
%

A \code{variable} element must contain a \hyperref[sec:taskReference]{taskReference} if it occurs inside a \code{listOfVariables} inside a \hyperref[class:dataGenerator]{dataGenerator} element.
A \code{variable} element must contain a \hyperref[sec:modelReference]{modelReference} if it occurs inside a \code{listOfVariables} inside a \hyperref[class:computeChange]{computeChange} element.
A \code{variable} element appearing within a \hyperref[class:functionalRange]{functionalRange} or \hyperref[class:setValue]{setValue} element must contain a \hyperref[sec:modelReference]{modelReference} if and only if it references a model variable.

%
\lsttext{variable}{variable}

%
\begin{myXmlLst}{SED-ML \code{variable} definitions inside the \code{computeChange} element and inside the \code{dataGenerator} element}{lst:variable}
<sedML>
 <listOfModels>
  <model [..]>
   <listOfChanges>
    <computeChange target="TARGET ELEMENT OR ATTRIBUTE">
     <listOfVariables>
       <variable id="v1" name="maximum velocity" 
        target="XPath TO A MODEL ELEMENT OR ATTRIBUTE IN ANY SPECIFIED MODEL" />
      [FURTHER VARIABLE DEFINITIONS]
     </listOfVariables>
     [..]
    </computeChange>
   </listOfChanges>
   [..]
  </model>
  [..]
 </listOfModels>
 <listOfDataGenerators>
  <dataGenerator [..]>
   <listOfVariables>
    <variable id="v2" name="time" taskReference="task1" symbol="urn:sedml:symbol:time" />
      [FURTHER VARIABLE DEFINITIONS]
   </listOfVariables>
  </dataGenerator>
 </listOfDataGenerators>
 [..]
</sedML>
\end{myXmlLst}
%
Listing \ref{lst:variable} defines a variable \code{v1} (line 7) to compute a change on a model constituent (referenced by the \code{target} attribute on \element{computeChange} in line 5). The value of \code{v1} corresponds with the value of the targeted model constituent referenced by the \code{target} attribute in line 8. 
The second variable, \code{v2} (line 21), is used inside a \code{dataGenerator}. As the variable is \concept{time} as used in \code{task1}, the \code{symbol} attribute is used to refer to the SED-ML URI for time (line 21).


%% ~~ TARGET ~~
\subsubsection{\element{target}}
\label{sec:target}
An instance of \concept{Variable} can refer to a model constituent inside a particular \hyperref[class:model]{model} through an \concept{XPath} expression stored in the \concept{target} attribute. 

XPath can be used to unambiguously identify an element or attribute in an XML file.

The \concept{target} attribute may also be used to reference an entity within the SED-ML file itself, by containing a fragment identifier consisting of a hash character (\code{\#}) followed by the \concept{id} of the desired element. As of SED-ML \currentLV this is only used to refer to \hyperref[sec:ranges]{ranges} within a \hyperref[class:repeatedTask]{repeatedTask} (see Listing~\ref{lst:repeatedTask} for an example).

\lsttexta{target}{target}
%
\begin{myXmlLst}{SED-ML \code{target} definition}{lst:target}
  <listOfVariables>
    <variable id="v1" name="TetR protein" taskReference="task1" 
      target="/sbml:sbml/sbml:listOfSpecies/sbml:species[@id='PY']" />
  </listOfVariables>
\end{myXmlLst}

It should be noted that the identifier and names inside the SED-ML document do not \emph{have} to match the identifiers and names that the model and its constituents carry in the model definition.
In listing \vref{lst:target}, the variable with ID \code{v1} is defined. It is described as the \code{TetR protein}. The reference points to a species in the referenced SBML model. The particular species can be identified through its ID in the SBML model, namely \code{PY}.
However, SED-ML also permits using identical identifiers and names as in the referenced models. The following Listing~\vref{lst:sedmlVariable} is another valid example for the specification of a variable, but uses the same naming in the variable definition as in the original model (as opposed to Listing~\ref{lst:target}):

\begin{myXmlLst}{SED-ML variable definition using the original model identifier and name in SED-ML}{lst:sedmlVariable}
   <listOfVariables>
    <variable id="PY" name="TetR protein"  taskReference="task1" 
     target="/sbml:sbml/sbml:listOfSpecies/sbml:species[@id='PY']" />
   </listOfVariables>
\end{myXmlLst}

\begin{myXmlLst}{Species definition in the referenced model (extracted from \url{urn:miriam:biomodels.db:BIOMD0000000012})}{lst:sbmlModel}
<sbml [..]>
 <listOfSpecies]
  <species metaid="PY" id="PY" name="TetR protein" [..]>
   [..]
  </species>
 </listOfSpecies>
 [..]
</sbml>
\end{myXmlLst}

The XPath expression used in the \concept{\code{target}} attribute unambiguously leads to the particular place in the XML SBML model -- the species is to be found in the \emph{sbml} element, and there inside the \emph{listOfSpecies} (Listing~\vref{lst:sbmlModel}). Note that while it is possible to write XPath expressions that select multiple nodes within a referenced model, when used within a \concept{target} attribute a single element or attribute \emph{must} be selected by the expression.


%% ~~ SYMBOL ~~
\subsubsection{\element{symbol}}
\label{sec:symbol}

\concept{Symbols} are predefined, implicit variables that can be called in a SED-ML file by referring to the defined URNs representing that variable's concept. The notion of implicit variables is explained in Section~\ref{sec:implicitVariable} on \refpage{sec:implicitVariable}.

\lsttexta{symbol}{symbol}
The example encodes a computed change of model \code{m001}. To specify that change, a symbol is defined (i.\,e.\  the SED-ML symbol for \code{time} is assigned to the variable \code{t1}). How to compute the change itself is explained in Section~\ref{class:computeChange}.
%
\begin{myXmlLst}{SED-ML \code{symbol} definition}{lst:symbol}
  <listOfVariables>
    <variable id="t1" name="time" taskReference="task1" 
      symbol="urn:sedml:symbol:time" />
  </listOfVariables>
\end{myXmlLst}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% PARAMETER
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{\element{Parameter}}
\label{class:parameter}
The SED-ML \concept{Parameter} class creates instances with a constant value (\fig{parameter}).

\sedfig[width=0.3\textwidth]{pdf/parameterClass}{The Parameter class}{fig:parameter}

SED-ML allows the use of named parameters wherever a mathematical expression is defined to compute some value (e.g.\ in \hyperref[class:computeChange]{ComputeChange}, \hyperref[class:functionalRange]{FunctionalRange} or \hyperref[class:dataGenerator]{DataGenerator}). In all cases the parameter definitions are local to the particular class defining them. A benefit of naming parameters rather than including numbers directly within the mathematical expression is that \hyperref[class:notes]{notes} and \hyperref[class:annotation]{annotations} may be associated with them.

\tabtext{parameter}{parameter}

\begin{table}[ht!]
\center
\begin{tabular}{|l|l|}
\hline
\textbf{\attribute} & \textbf{\desc}\\
\hline
metaid$^{o}$ & \refpage{sec:metaID} \\
id & \refpage{sec:id}\\
name$^{o}$ & \refpage{sec:name}\\
\hline
value & \refpage{sec:value}\\
\hline
\hline
\textbf{\subelements} & \textbf{\desc}\\
\hline
notes$^{o}$ & \refpage{class:notes}\\
annotation$^{o}$ & \refpage{class:annotation}\\
\hline
\end{tabular}
\caption{\tabcap{parameter}}
\label{tab:parameter}
\end{table}

A parameter can unambiguously be identified through its given \hyperref[sec:id]{id}. It may additionally carry an optional \hyperref[sec:name]{name}. Each parameter has one associated \hyperref[sec:value]{value}. 

\lsttext{parameter}{parameter}
The listing shows the definition of a parameter \code{p1} with the \code{value="40"} assigned. 

\begin{myXmlLst}{The definition of a parameter in SED-ML}{lst:parameter}
<listOfParameters>
 <parameter id="p1" name="KM" value="40" />
</listOfParameters>
\end{myXmlLst}


%% ~~~ VALUE ~~
\subsubsection{\element{value}}
\label{sec:value}
Each \concept{parameter} has exactly one fixed \concept{value}. The \code{value} attribute of XML data type \code{Double} is required for each \code{parameter} element. 


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% LIST OF ELEMENTS
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{ListOf* containers}
\label{listOfElements}
SED-ML \concept{listOf*} elements serve as containers  for a collection of objects of the same type. For example, the \code{listOfModels} contains all \hyperref[class:model]{Model} objects of a SED-ML document. Lists do not carry any further semantics nor do they add additional attributes to the language. They might, however, be annotated with \hyperref[class:notes]{Notes} and \hyperref[class:annotation]{Annotations} as they are derived from \hyperref[class:sedBase]{SEDBase}. All \concept{listOf*} elements are optional in a SED-ML document. 


%% ~~~ LIST OF DATA DESCRIPTIONS ~~
\subsubsection{listOfDataDescriptions: The dataDescription definition container}
\label{sec:listOfDataDescription}

\hl{TODO: WRITE, see issue \url{https://github.com/SED-ML/sed-ml/issues/9}}


%% ~~~ LIST OF VARIABLES ~~
\subsubsection{listOfVariables: The variable definition container}
\label{sec:listOfVariables}

SED-ML uses the \hyperref[class:variable]{variable} concept to refer to existing entities inside a model. The container for all variables is  \concept{listOfVariables} (\fig{listOfVariables}). It includes all variables that need to be defined to either describe a change in the model by means of mathematical equations (\hyperref[class:computeChange]{ComputeChange}) or to set up a \hyperref[class:dataGenerator]{dataGenerator}.

% Fig: sed model
\sedfig[width=0.85\textwidth]{pdf/listOfVariables}{The SED-ML listOfVariables container}{fig:listOfVariables}
%

\lsttext{listOfVariables}{listOfVariables}  
 The \code{listOfVariables} is optional and may contain zero to many variables. 
%
\begin{myXmlLst}{SED-ML listOfVariables element}{lst:listOfVariables}
<listOfVariables>
 <variable id="v1" name="maximum velocity" taskReference="task1" 
     target="/cellml:model/cellml:component[@cmeta:id='MP']/cellml:variable[@name='vsP']/@initial_value" />
 <variable id="v2" taskReference="task2" symbol="urn:sedml:symbol:time" />
</listOfVariables>
\end{myXmlLst}


%% ~~~ LIST OF PARAMETERS ~~
\subsubsection{listOfParameters: The parameter definition container}
\label{sec:listOfParameters}
All \hyperref[class:parameter]{parameters} needed throughout the simulation experiment, whether to compute a change on a model prior to or during simulation (\hyperref[class:computeChange]{ComputeChange} and \hyperref[class:setValue]{SetValue}), to compute values in a \hyperref[class:functionalRange]{FunctionalRange}, or to set up a \hyperref[class:dataGenerator]{DataGenerator}, are defined inside a \concept{listOfParameters} (\fig{listOfParameters}).

\sedfig[width=0.85\textwidth]{pdf/listOfParameters}{The SED-ML \code{listOfParameters} container}{fig:listOfParameters}

\lsttext{listOfParameters}{listOfParameters}
The element is optional and may contain zero to many parameters.

\begin{myXmlLst}{SED-ML \code{listOfParameters} element}{lst:listOfParameters}
<listOfParameters>
 <parameter id="p1" value="1" />
 <parameter id="p2" name="Kadp_2" value="0.23" />
</listOfParameters>
\end{myXmlLst}


%% ~~~ LIST OF MODELS ~~
\subsubsection{listOfModels: The model description container}
\label{sec:listOfModels}
In order to specify a simulation experiment, the participating models have to be defined. SED-ML uses the \concept{listOfModels} container for all necessary models (\fig{listOfModels}). 

\sedfig[width=0.85\textwidth]{pdf/listOfModels}{The SED-ML listOfModels container}{fig:listOfModels}

\lsttext{listOfModels}{listOfModels}
The \code{listOfModels} is optional and may contain zero to many models. However, if the \currentLV document contains  one or more \code{Task} elements, at least one \code{Model} element must be defined to which the \code{Task} element refers (c.f.\ Section~\ref{sec:modelReference} on \refpage{sec:modelReference}).

\begin{myXmlLst}{SED-ML listOfModels element}{lst:listOfModels}
<listOfModels>
 <model id="m0001" language="urn:sedml:language:sbml" 
  source="urn:miriam:biomodels.db:BIOMD0000000012" />
 <model id="m0002" language="urn:sedml:language:cellml" 
  source="http://models.cellml.org/workspace/leloup_gonze_goldbeter_1999/@@rawfile/d6613d7e1051b3eff2bb1d3d419a445bb8c754ad/leloup_gonze_goldbeter_1999_a.cellml" />
</listOfModels>
\end{myXmlLst}


%% ~~~ LIST OF CHANGES ~~
\subsubsection{listOfChanges: The change definition container}
\label{sec:listOfChanges}
The \concept{listOfChanges} contains the defined changes to be applied to a particular \hyperref[class:model]{model} (\fig{listOfChanges}). 

\sedfig[width=0.85\textwidth]{pdf/listOfChanges}{The SED-ML listOfChanges container}{fig:listOfChanges}

It always occurs as an optional subelement of the \element{model} element. 

\lsttext{listOfChanges}{listOfChanges}
The \code{listOfChanges} is nested inside the \code{model} element.

\begin{myXmlLst}{The SED-ML \element{listOfChanges} element, defining a change on a model}{lst:listOfChanges}
<model id="m0001" [..]>
 <listOfChanges>
  [CHANGE DEFINITION]
 </listOfChanges>
</model>
\end{myXmlLst}


%% ~~~ LIST OF SIMULATIONS ~~
\subsubsection{listOfSimulations: The simulation description container}
\label{sec:listOfSimulations}
The \concept{listOfSimulations} element is the container for \concept{simulation} descriptions (\fig{sedListOfSimulations}).

\sedfig[width=0.851\textwidth]{pdf/listOfSimulations}{The listOfSimulations container}{fig:sedListOfSimulations}


\lsttext{listOfSimulations}{listOfSimulation}
%
\begin{myXmlLst}{The SED-ML \element{listOfSimulations} element, containing two simulation setups}{lst:listOfSimulations}
 <listOfSimulations>
  <simulation id="s1" [..]>
   [UNIFORM TIMECOURSE DEFINITION]
  </simulation>
  <simulation id="s2" [..]>
   [UNIFORM TIMECOURSE DEFINITION]
  </simulation>
 </listOfSimulations>
\end{myXmlLst}

The \code{listOfSimulations} is optional and may contain zero to many simulations. However, if the \currentLV document contains one or more \code{Task} elements, at least one \code{Simulation} element must be defined to which  the \code{Task} element refers --- see section \ref{sec:simulationReference} on \refpage{sec:simulationReference}.


%% ~~~ LIST OF ALGORITHM PARAMETERS ~~
\subsubsection{listOfAlgorithmParameters: The container for algorithm parameters}
\label{sec:listOfAlgorithmParameters}
The \concept{listOfAlgorithmParameters} contains the the settings for the simulation algorithm used in a simulation experiment. It may list several instances of the \hyperref[class:algorithmParameter]{AlgorithmParameter} class.

\lsttext{listOfAlgorithmParameters}{listOfAlgorithmParameters}
The \code{listOfAlgorithmParameters} is optional and may contain zero to many parameters. 

\begin{myXmlLst}{SED-ML listOfAlgorithmParameters element}{lst:listOfAlgorithmParameters}
<listOfAlgorithmParameters>
  <algorithmParameter kisaoID="KISAO:0000211" value="23"/> 
</listOfAlgorithmParameters>
\end{myXmlLst}

 
%% ~~~ LIST OF TASKS ~~
\subsubsection{listOfTasks: The task specification container}
\label{sec:listOfTasks}
The \concept{listOfTasks} element contains the defined tasks for the simulation experiment (\fig{listOfTasks}).

\sedfig[width=0.85\textwidth]{pdf/listOfTasks}{The SED-ML listOfTasks container}{fig:listOfTasks}

\lsttext{listOfTasks}{listOfTasks}

\begin{myXmlLst}{The SED-ML \code{listOfTasks} element, defining one task}{lst:listOfTasks}
<listOfTasks>
 <task id="t1" name="simulating v1" modelReference="m1" simulationReference="s1">
 [FURTHER TASK DEFINITIONS]
</listOfTasks>
\end{myXmlLst}

The \code{listOfTasks} is optional and may contain zero to many tasks, each of which is an instance of a subclass of \hyperref[class:abstractTask]{AbstractTask}.
However, if the \currentLV document contains a \code{DataGenerator} element with at least one \code{Variable} element, at least one \concept{task} must be defined to which variable(s) in the \code{DataGenerator} element refer --- see Section~\ref{sec:taskReference} on \refpage{sec:taskReference}.


%% ~~~ LIST OF DATA GENERATORS ~~
\subsubsection{listOfDataGenerators: The post-processing container}
\label{sec:listOfDataGenerators}

In SED-ML, all variable- and parameter values that shall be used in the \hyperref[class:output]{Output} class need to be defined as a \hyperref[class:dataGenerator]{dataGenerator} beforehand. The container for those data generators is the \concept{listOfDataGenerators} (\fig{listOfDataGenerators}). 

\sedfig[width=0.85\textwidth]{pdf/listOfDataGenerators}{The SED-ML listOfDataGenerators container}{fig:listOfDataGenerators}

\lsttext{listOfDataGenerators}{listOfDataGenerators}
%
\begin{myXmlLst}{The \code{listOfDataGenerators} element, defining two data generators \emph{time} and \emph{LaCI repressor}}{lst:listOfDataGenerators}
<listOfDataGenerators>
 <dataGenerator id="d1" name="time">
  [DATA GENERATOR DEFINITION FOLLOWING]
 </dataGenerator>
 <dataGenerator id="LaCI" name="LaCI repressor">
  [DATA GENERATOR DEFINITION FOLLOWING]
 </dataGenerator>
</listOfDataGenerators>
\end{myXmlLst}

The \code{listOfDataGenerators} is optional and in general may contain zero to many DataGenerators. However, if the \currentLV document contains  an  \code{Output}  element, at least one  \code{DataGenerator} must be defined to which the \code{Output} element refers -  see section \ref{sec:dataReference} on \refpage{sec:dataReference}.


%% ~~ LIST OF OUTPUTS ~~
 \subsubsection{listOfOutputs: The output specification container}
\label{sec:listOfOutputs}
The \concept{listOfOutputs} container holds the output specifications for a simulation experiment. 

\sedfig[width=0.85\textwidth]{pdf/listOfOutputs}{The SED-ML listOfOutputs container}{fig:listOfOutputs}

The output can be defined as either a \hyperref[class:report]{report}, a \hyperref[class:plot2D]{plot2D} or  as a \hyperref[class:plot3D]{plot3D}. 

\lsttext{listOfOutputs}{listOfOutputs}
The \code{listOfOutputs} is optional and may contain zero to many outputs. 

\begin{myXmlLst}{The \code{listOfOutput} element}{lst:listOfOutputs}
<listOfOutputs>
 <report id="report1">
  [REPORT DEFINITION FOLLOWING]
 </report>
 <plot2D id="plot1">
  [2D PLOT DEFINITION FOLLOWING] 
 </plot2D>
</listOfOutputs>
\end{myXmlLst}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../sed-ml-L1V3"
%%% End: 
